**Критерий согласия Колмогорова-Смирнова** — это непараметрический статистический тест, который оценивает, насколько [[Эмпирическая функция распределения|эмпирическая функция распределения (ЭФР)]], построенная по выборке, согласуется с теоретической функцией распределения. Этот критерий широко используется для проверки гипотез о том, что выборка следует определённому теоретическому распределению (например, нормальному, экспоненциальному), или для сравнения двух выборок, чтобы определить, принадлежат ли они одному и тому же распределению.
#### Статистика теста Колмогорова-Смирнова

Статистика Колмогорова-Смирнова измеряет максимальное отклонение эмпирической функции распределения от теоретической:$$D_n = \sup_x |F_n(x) - F(x)|$$Здесь $\sup_x$​ означает максимальное отклонение по всем значениям $x$.
### Гипотезы
- **Нулевая гипотеза** ($H_0$​): Выборка следует теоретическому распределению $F(x)$.
- **Альтернативная гипотеза** ($H_1$): Выборка не следует этому распределению.
### Критические значения
Для проверки гипотезы нужно сравнить статистику $D_n$​ с критическим значением, которое зависит от размера выборки $n$ и уровня значимости $\alpha$ (обычно $\alpha = 0.05$).

Если $D_n$​ больше критического значения, нулевая гипотеза отвергается, и можно считать, что выборка не следует теоретическому распределению.
### Критерий Колмогорова-Смирнова для двух выборок

Этот тест также может применяться для сравнения двух выборок. В этом случае проверяется гипотеза о том, принадлежат ли обе выборки одному и тому же распределению.

Статистика для двух выборок $X_1, X_2, \dots, X_m$​ и $Y_1, Y_2, \dots, Y_n$​ будет:$$D_{m,n} = \sup_x |F_m(x) - G_n(x)|$$где $F_m(x)$ и $G_n(x)$ — эмпирические функции распределения двух выборок.
## Пример
#### 1. **Формулировка гипотезы**

- **Нулевая гипотеза $H_0$**: Данные следуют нормальному распределению $N(\mu, \sigma^2)$.
- **Альтернативная гипотеза $H_1$**: Данные не следуют нормальному распределению.

#### 2. **Сбор выборки**

Пусть у нас есть набор данных:$$X = \{2.1, 2.3, 1.9, 2.5, 2.7, 3.1, 1.8, 2.0, 2.6, 3.0\}$$Эта выборка состоит из 10 наблюдений.
#### 3. **Расчет параметров нормального распределения**

Для применения критерия Колмогорова-Смирнова к нормальному распределению, нам нужно знать параметры $\mu$ и $\sigma^2$. Если они неизвестны, их можно оценить по выборке:

- Оценка среднего $\hat{\mu}$:$$\hat{\mu} = \frac{1}{n} \sum_{i=1}^{n} X_i = \frac{2.1 + 2.3 + \dots + 3.0}{10} = 2.4$$
- Оценка дисперсии $\hat{\sigma}^2$:$$\hat{\sigma}^2 = \frac{1}{n} \sum_{i=1}^{n} (X_i - \hat{\mu})^2 = \frac{1}{10} \left[(2.1 - 2.4)^2 + (2.3 - 2.4)^2 + \dots + (3.0 - 2.4)^2 \right] = 0.173$$
Таким образом, мы предполагаем, что данные следуют нормальному распределению с параметрами $\hat{\mu} = 2.4$ и $\hat{\sigma}^2 = 0.173$.
#### 4. **Построение эмпирической функции распределения (ЭФР)**

Для выполнения теста Колмогорова-Смирнова, нужно построить **эмпирическую функцию распределения** по данным $X$. Это шаговая функция, которая для каждого значения $x$ показывает долю элементов выборки, меньших или равных $x$.

Эмпирическая функция для нашей выборки будет выглядеть так:$$F_n(x) = \begin{cases} 0, & \text{если } x < 1.8 \\ 0.1, & \text{если } 1.8 \leq x < 1.9 \\ 0.2, & \text{если } 1.9 \leq x < 2.0 \\ 0.3, & \text{если } 2.0 \leq x < 2.1 \\ \vdots & \vdots \\ 1.0, & \text{если } x \geq 3.0 \end{cases}$$​Дальше нужно найти значения $F(x)$, потом найти оценку $D_n$. Эту оценку надо сравнить с критическим значением, которое ищется в каких-то таблицах.